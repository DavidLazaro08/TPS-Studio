# üìä TPS Studio - Estado del Proyecto y Pr√≥ximos Pasos

## üéØ Resumen Ejecutivo

**TPS Studio** es una aplicaci√≥n JavaFX para dise√±o y preimpresi√≥n de tarjetas pl√°sticas CR80 (85.60 √ó 53.98 mm) y acreditaciones.

**Estado Actual**: ‚úÖ **Refactoring completado** - Editor funcional con arquitectura limpia  
**Pr√≥ximo Paso Cr√≠tico**: üöÄ **Implementar persistencia** (guardar/abrir proyectos)

---

## üìÅ Documentaci√≥n Analizada

He revisado todos los documentos en `docs/`:

1. **README.md** - Descripci√≥n general del proyecto
2. **mainviewcontroller_audit.md.resolved** - Plan detallado de refactoring (866 l√≠neas)
3. **refactoring_audit_for_dummies.md.resolved** - Explicaci√≥n del refactoring completado
4. **PDFs** (no le√≠dos - binarios):
   - `02_Estudio_TPS Studio_DavidGutierrez_ST.pdf`
   - [AutoEvaluacion_EN02_DavidGutierrez.pdf](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/docs/AutoEvaluacion_EN02_DavidGutierrez.pdf)
   - [Primera_Iteracion_TPS_Studio.pdf](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/docs/Primera_Iteracion_TPS_Studio.pdf)
   - `Proyecto TPS Studio_IT01_David_Gutierrez.pdf`
   - [TPS_Studio_Funcionalidades_Diferenciales.pdf](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/docs/TPS_Studio_Funcionalidades_Diferenciales.pdf)

---

## ‚úÖ Lo que YA est√° IMPLEMENTADO

### **1. Arquitectura Refactorizada** (100% completo)

El refactoring del [MainViewController](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/view/MainViewController.java#24-1156) (1594 l√≠neas ‚Üí 5 clases) est√° **completado**:

| Clase | L√≠neas | Estado | Responsabilidad |
|-------|--------|--------|-----------------|
| [MainViewController](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/view/MainViewController.java#24-1156) | 551 | ‚úÖ Completo | Coordinaci√≥n UI, eventos FXML |
| [EditorCanvasManager](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/view/EditorCanvasManager.java#19-546) | 567 | ‚úÖ Completo | Renderizado canvas, mouse events |
| [PropertiesPanelController](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/view/PropertiesPanelController.java#22-485) | 485 | ‚úÖ Completo | Panel de propiedades din√°mico |
| [ModeManager](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/view/ModeManager.java#21-379) | 379 | ‚úÖ Completo | Gesti√≥n de modos DESIGN/PRODUCTION |
| [ProjectManager](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#24-294) | 294 | ‚úÖ Completo | L√≥gica de negocio (CRUD b√°sico) |

**Beneficios obtenidos:**
- ‚úÖ C√≥digo mantenible y testeable
- ‚úÖ Separaci√≥n de responsabilidades clara
- ‚úÖ Sin c√≥digo duplicado
- ‚úÖ Arquitectura escalable

---

### **2. Editor de Tarjetas CR80** (Funcional)

#### **Canvas y Renderizado**
- ‚úÖ Tarjeta CR80 con medidas reales (85.60 √ó 53.98 mm)
- ‚úÖ √Årea de sangrado (2mm por lado)
- ‚úÖ Gu√≠as de seguridad (3mm)
- ‚úÖ Zoom (50% - 200%)
- ‚úÖ Frente/Dorso

#### **Elementos Editables**
- ‚úÖ **Textos**:
  - Fuente, tama√±o, color
  - Posici√≥n (X, Y)
  - Ancho ajustable
  - Drag & drop
  - Resize con handle derecho
  
- ‚úÖ **Im√°genes**:
  - Carga desde archivo (PNG, JPG, JPEG, GIF)
  - Posici√≥n (X, Y)
  - Tama√±o (ancho √ó alto)
  - Mantener proporci√≥n
  - Drag & drop
  - Resize con 4 handles (esquinas)
  
- ‚úÖ **Fondos**:
  - Carga desde archivo
  - Fit modes: CON SANGRE / SIN SANGRE
  - Preferencia "No volver a preguntar"
  - Edici√≥n externa (Photoshop/GIMP)
  - Recarga desde disco

#### **Interacci√≥n**
- ‚úÖ Selecci√≥n de elementos (clic)
- ‚úÖ Drag & drop
- ‚úÖ Resize con handles
- ‚úÖ Eliminaci√≥n (tecla DELETE)
- ‚úÖ Bloqueo/desbloqueo de elementos
- ‚úÖ Panel de capas (layers)
- ‚úÖ Panel de propiedades din√°mico

#### **Modos de Trabajo**
- ‚úÖ **Modo DISE√ëO**: Toolbox + Capas + Propiedades
- ‚úÖ **Modo PRODUCCI√ìN**: Lista de proyectos + Export controls

---

### **3. Gesti√≥n de Proyectos** (B√°sico)

- ‚úÖ Crear nuevo proyecto CR80
- ‚úÖ Lista de proyectos en memoria
- ‚úÖ Selecci√≥n de proyecto activo
- ‚úÖ A√±adir/eliminar elementos

---

### **4. UI/UX**

- ‚úÖ Login screen con animaciones
- ‚úÖ Transici√≥n animada Login ‚Üí Main
- ‚úÖ Paneles laterales con animaciones (slide + fade)
- ‚úÖ Tema oscuro moderno
- ‚úÖ Sombras y efectos visuales

---

## ‚ùå Lo que FALTA por IMPLEMENTAR

### **üî¥ Cr√≠tico (Bloquea uso real)**

#### **1. Persistencia de Proyectos** (NO implementado)

**Estado actual**: Placeholders vac√≠os en [ProjectManager](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#24-294)
```java
public void abrirProyecto() {
    System.out.println("Abrir (placeholder)");
}

public void guardarProyecto() {
    System.out.println("Guardar (placeholder)");
}
```

**Lo que falta:**
- [ ] Serializaci√≥n de proyectos a JSON
- [ ] Guardar proyecto en disco (.tps o .json)
- [ ] Abrir proyecto desde disco
- [ ] Di√°logo "Guardar cambios" al cerrar
- [ ] Gesti√≥n de rutas de archivos (im√°genes relativas vs absolutas)
- [ ] Validaci√≥n de integridad al cargar

**Impacto**: **SIN ESTO, LA APP NO ES USABLE** (se pierde todo al cerrar)

---

#### **2. Exportaci√≥n a PDF/PNG** (NO implementado)

**Estado actual**: Placeholder vac√≠o
```java
public void exportarProyecto() {
    System.out.println("Exportar (placeholder)");
}
```

**Lo que falta:**
- [ ] Exportar frente/dorso a PNG (resoluci√≥n impresi√≥n: 300 DPI)
- [ ] Exportar a PDF listo para imprenta
- [ ] Opciones de exportaci√≥n:
  - Con sangrado / Sin sangrado
  - Marcas de corte
  - Resoluci√≥n personalizable
- [ ] Preview antes de exportar

**Impacto**: **SIN ESTO, NO SE PUEDE IMPRIMIR** (objetivo principal de la app)

---

### **üü° Importante (Mejora funcionalidad)**

#### **3. Base de Datos** (NO implementado)

**Seg√∫n README**:
> Base de datos local (pendiente de definir)

**Lo que falta:**
- [ ] Definir qu√© se guarda en BD:
  - ¬øProyectos? (o solo en archivos JSON?)
  - ¬øPlantillas reutilizables?
  - ¬øHistorial de proyectos?
  - ¬øConfiguraci√≥n de usuario?
- [ ] Elegir tecnolog√≠a (SQLite, H2, o solo archivos?)
- [ ] Implementar DAO/Repository
- [ ] Migrar [ProjectManager](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#24-294) a usar BD

**Impacto**: Mejora organizaci√≥n y b√∫squeda de proyectos

---

#### **4. Campos Variables** (NO implementado)

**Seg√∫n README**:
> Permitir la creaci√≥n de plantillas con medidas reales, **campos variables** y exportaci√≥n a PDF

**Lo que falta:**
- [ ] Definir qu√© son "campos variables":
  - ¬øPlaceholders tipo `{{NOMBRE}}`, `{{ID}}`?
  - ¬øImportar datos desde CSV/Excel?
  - ¬øGeneraci√≥n masiva de tarjetas?
- [ ] Implementar sistema de templates
- [ ] Interfaz para definir variables
- [ ] L√≥gica de reemplazo al exportar

**Impacto**: Funcionalidad diferencial para producci√≥n masiva

---

#### **5. Plantillas Predefinidas** (NO implementado)

**Lo que falta:**
- [ ] Galer√≠a de plantillas (ej: tarjeta corporativa, acreditaci√≥n evento, etc.)
- [ ] Sistema de categor√≠as
- [ ] Importar/exportar plantillas
- [ ] Marketplace de plantillas (futuro)

**Impacto**: Acelera creaci√≥n de proyectos

---

### **üü¢ Opcional (Nice to have)**

#### **6. Mejoras de Editor**

- [ ] Deshacer/Rehacer (Undo/Redo)
- [ ] Copiar/Pegar elementos
- [ ] Duplicar elemento
- [ ] Alinear elementos (izquierda, centro, derecha, distribuir)
- [ ] Agrupar/desagrupar elementos
- [ ] Orden de capas (traer al frente, enviar al fondo)
- [ ] Reglas y gu√≠as personalizadas
- [ ] Snap to grid
- [ ] Rotaci√≥n de elementos

#### **7. Mejoras de UI**

- [ ] Atajos de teclado (Ctrl+S, Ctrl+Z, etc.)
- [ ] Barra de herramientas superior
- [ ] Miniatura de vista previa
- [ ] Historial de proyectos recientes
- [ ] B√∫squeda de proyectos
- [ ] Temas personalizables

#### **8. Exportaci√≥n Avanzada**

- [ ] Exportar solo frente o solo dorso
- [ ] Exportar m√∫ltiples tarjetas en una hoja
- [ ] Exportar con c√≥digo QR
- [ ] Exportar a formatos vectoriales (SVG, EPS)

---

## üöÄ Recomendaci√≥n de Pr√≥ximos Pasos

### **Prioridad 1: Persistencia (CR√çTICO)**

**Objetivo**: Poder guardar y abrir proyectos

**Tareas**:
1. **Dise√±ar formato JSON** (1-2h)
   ```json
   {
     "nombre": "Tarjeta CR80 #1",
     "version": "1.0",
     "frente": {
       "elementos": [
         {
           "tipo": "texto",
           "id": "txt1",
           "contenido": "Nombre",
           "x": 50,
           "y": 50,
           "fuente": "Arial",
           "tama√±o": 14,
           "color": "#000000"
         },
         {
           "tipo": "imagen",
           "id": "img1",
           "ruta": "imagenes/logo.png",
           "x": 100,
           "y": 100,
           "ancho": 50,
           "alto": 50
         }
       ],
       "fondo": {
         "ruta": "fondos/fondo1.jpg",
         "fitMode": "BLEED"
       }
     },
     "dorso": { ... }
   }
   ```

2. **Implementar serializaci√≥n** (2-3h)
   - Crear clases DTO (Data Transfer Objects)
   - Usar Gson o Jackson para JSON
   - M√©todos `toJSON()` en modelos
   - M√©todos `fromJSON()` para deserializar

3. **Implementar [guardarProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#92-98)** (2h)
   - FileChooser para elegir ubicaci√≥n
   - Guardar JSON en disco
   - Guardar rutas relativas de im√°genes
   - Copiar im√°genes a carpeta del proyecto (opcional)

4. **Implementar [abrirProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#85-91)** (2h)
   - FileChooser para seleccionar .tps
   - Cargar JSON desde disco
   - Reconstruir objetos Proyecto/Elemento
   - Validar rutas de im√°genes
   - Manejo de errores (archivo corrupto, im√°genes faltantes)

5. **Di√°logo "Guardar cambios"** (1h)
   - Detectar cambios no guardados
   - Mostrar di√°logo al cerrar app
   - Opciones: Guardar / No guardar / Cancelar

**Tiempo estimado**: 8-10 horas  
**Beneficio**: App usable en producci√≥n

---

### **Prioridad 2: Exportaci√≥n a PDF/PNG (CR√çTICO)**

**Objetivo**: Generar archivos listos para imprenta

**Tareas**:
1. **Exportar a PNG** (3-4h)
   - Renderizar canvas a imagen (WritableImage)
   - Escalar a 300 DPI (85.60mm √ó 300 DPI / 25.4 = 1012px ancho)
   - Guardar con ImageIO
   - Opciones: con/sin sangrado

2. **Exportar a PDF** (4-5h)
   - Usar librer√≠a: iText, Apache PDFBox, o JavaFX PDF
   - Crear PDF con medidas exactas (85.60 √ó 53.98 mm)
   - Incrustar im√°genes y textos
   - A√±adir marcas de corte (opcional)

3. **Di√°logo de exportaci√≥n** (2h)
   - Opciones: formato (PNG/PDF), resoluci√≥n, sangrado
   - Preview antes de exportar
   - Progreso de exportaci√≥n

**Tiempo estimado**: 9-11 horas  
**Beneficio**: Cumple objetivo principal (preimpresi√≥n)

---

### **Prioridad 3: Campos Variables (IMPORTANTE)**

**Objetivo**: Generaci√≥n masiva de tarjetas

**Tareas**:
1. **Dise√±ar sistema de variables** (2h)
   - Sintaxis: `{{VARIABLE}}`
   - Tipos: texto, imagen, c√≥digo QR
   - Interfaz para definir variables

2. **Importar datos desde CSV** (3h)
   - FileChooser para CSV
   - Parser CSV
   - Mapeo columnas ‚Üí variables

3. **Generaci√≥n masiva** (4h)
   - Iterar filas del CSV
   - Reemplazar variables en plantilla
   - Exportar m√∫ltiples PDFs/PNGs

**Tiempo estimado**: 9 horas  
**Beneficio**: Funcionalidad diferencial

---

### **Prioridad 4: Base de Datos (OPCIONAL)**

**Decisi√≥n**: ¬øRealmente se necesita?

**Alternativa simple**: Usar solo archivos JSON
- Proyectos guardados como `.tps` (JSON)
- Carpeta `proyectos/` con subcarpetas por proyecto
- Historial de recientes en `config.json`

**Si se decide implementar BD**:
- SQLite para portabilidad
- Tablas: `proyectos`, `plantillas`, `configuracion`
- Tiempo estimado: 6-8 horas

---

## üìã Plan de Implementaci√≥n Sugerido

### **Sprint 1: Persistencia (2 semanas)**
- Semana 1: Serializaci√≥n JSON + Guardar
- Semana 2: Abrir + Validaciones + Di√°logo cambios

### **Sprint 2: Exportaci√≥n (2 semanas)**
- Semana 1: Exportar PNG + Opciones
- Semana 2: Exportar PDF + Preview

### **Sprint 3: Campos Variables (2 semanas)**
- Semana 1: Sistema de variables + UI
- Semana 2: Importar CSV + Generaci√≥n masiva

### **Sprint 4: Mejoras (1-2 semanas)**
- Undo/Redo
- Atajos de teclado
- Plantillas predefinidas

---

## üéØ M√©tricas de Progreso

| Funcionalidad | Completado | Pendiente | Prioridad |
|---------------|------------|-----------|-----------|
| **Arquitectura** | 100% | 0% | ‚úÖ Completo |
| **Editor b√°sico** | 100% | 0% | ‚úÖ Completo |
| **Persistencia** | 0% | 100% | üî¥ Cr√≠tico |
| **Exportaci√≥n** | 0% | 100% | üî¥ Cr√≠tico |
| **Campos variables** | 0% | 100% | üü° Importante |
| **Base de datos** | 0% | 100% | üü¢ Opcional |
| **Mejoras editor** | 30% | 70% | üü¢ Opcional |

**Progreso global**: ~40% (arquitectura + editor b√°sico completos)

---

## üí° Recomendaci√≥n Final

**Enf√≥cate en Prioridad 1 y 2** (Persistencia + Exportaci√≥n):

1. **Implementar [guardarProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#92-98) y [abrirProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#85-91)** (Sprint 1)
   - Esto hace la app **usable**
   - Permite probar con proyectos reales
   - Base para todo lo dem√°s

2. **Implementar exportaci√≥n a PNG/PDF** (Sprint 2)
   - Cumple el objetivo principal (preimpresi√≥n)
   - Valida que el renderizado es correcto
   - Permite mostrar resultados a usuarios

3. **Despu√©s, evaluar necesidad de campos variables** (Sprint 3)
   - Depende de feedback de usuarios
   - Puede ser diferenciador vs competencia

**Con estos 2 sprints (4 semanas), tendr√°s una app MVP funcional y lista para producci√≥n.**

---

## üìù Notas Adicionales

### **Tecnolog√≠as Sugeridas**

- **JSON**: Gson (simple) o Jackson (robusto)
- **PDF**: iText 7 (comercial) o Apache PDFBox (open source)
- **BD** (si se decide): SQLite + JDBC

### **Estructura de Archivos Propuesta**

```
proyectos/
‚îú‚îÄ‚îÄ tarjeta_corporativa_001/
‚îÇ   ‚îú‚îÄ‚îÄ proyecto.tps (JSON)
‚îÇ   ‚îú‚îÄ‚îÄ imagenes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logo.png
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ foto.jpg
‚îÇ   ‚îî‚îÄ‚îÄ fondos/
‚îÇ       ‚îî‚îÄ‚îÄ fondo.jpg
‚îî‚îÄ‚îÄ acreditacion_evento_002/
    ‚îî‚îÄ‚îÄ ...
```

### **Formato de Archivo `.tps`**

- Extensi√≥n personalizada (asociar con TPS Studio)
- Internamente: JSON comprimido (ZIP) con im√°genes embebidas
- Alternativa: JSON plano + carpeta de assets

---

## ‚úÖ Conclusi√≥n

**Estado actual**: Refactoring completo, editor funcional  
**Bloqueador cr√≠tico**: Falta persistencia y exportaci√≥n  
**Pr√≥ximo paso**: Implementar [guardarProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#92-98) y [abrirProyecto()](file:///c:/Users/Usuario/Documents/Grado%20S%20Programaci%C3%B3n%20-%20SEGUNDO/00%20PROYECTO%20FINAL/TPS_STUDIO_APP/TPS_Studio/tps-studio/src/main/java/com/tpsstudio/service/ProjectManager.java#85-91)  
**Tiempo estimado MVP**: 4 semanas (2 sprints)

**¬øQuieres que empiece con la implementaci√≥n de persistencia?** üöÄ
